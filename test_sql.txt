#
#コマンドラインのほうでsqlを使って
#動作確認をしたいとき様の
#クエリ集
#






#確認用：全表示
SELECT * FROM event_date;
SELECT * FROM event;
SELECT * FROM attendance;
SELECT * FROM member;




##全表示
SELECT 
        *
    FROM 
        member
    INNER JOIN 
            attendance
        ON 
            member.member_id = attendance.member_id 
    INNER JOIN
            event_date
        ON
            attendance.event_date_id = event_date.event_date_id
    INNER JOIN
            event
        ON
            event_date.event_id = event.event_id
    ORDER BY
        created_at;





#データベースのリセット
#DBを消す
DROP    DATABASE chosei_kun;

#DBを作る
CREATE  DATABASE chosei_kun
    DEFAULT CHARACTER SET utf8
    COLLATE utf8_general_ci;

#DBを選択
USE chosei_kun;

#各テーブルを作成
CREATE TABLE event(
    event_id	     BIGINT      PRIMARY KEY     AUTO_INCREMENT,
    event_name	     CHAR(200)   NOT NULL,
    event_memo	     TEXT        NOT NULL       DEFAULT '', 
    url_rand     	 CHAR(60)    NOT NULL       UNIQUE          DEFAULT '123456789abcdefghij',
    host_cookie	     CHAR(50)    NOT NULL       DEFAULT '12345',
    created_at       DATETIME    NOT NULL    
)ENGINE = InnoDB;
CREATE TABLE event_date(
    event_date_id    BIGINT      PRIMARY KEY     AUTO_INCREMENT,
    event_date	     CHAR(50)    NOT NULL,
    event_id	     BIGINT      NOT NULL,
    FOREIGN KEY(event_id) REFERENCES event (event_id) ON DELETE CASCADE
)ENGINE = InnoDB;
CREATE TABLE member(
    member_id	     BIGINT      PRIMARY KEY     AUTO_INCREMENT,
    member_name	     CHAR(50)    NOT NULL,
    member_comment	 CHAR(200)   NOT NULL        DEFAULT ''
)ENGINE = InnoDB;
CREATE TABLE attendance(
    event_date_id    BIGINT,
    member_id	     BIGINT,     
    attendance	 INT         NOT NULL        DEFAULT 0,
    PRIMARY KEY(event_date_id, member_id),
    FOREIGN KEY(member_id) REFERENCES member (member_id) ON DELETE CASCADE,
    FOREIGN KEY(event_date_id) REFERENCES event_date (event_date_id) ON DELETE CASCADE
)ENGINE = InnoDB;

